schema: '2.0'
stages:
  _check-env-tex:
    cmd: calkit check environment --name tex
    outs:
    - path: .calkit/env-locks/tex.json
      hash: md5
      md5: 1d0f47499b5986e3b18b700441dc8e3d
      size: 1045
  sync-overleaf:
    cmd: bash --noprofile --norc -c "calkit overleaf sync --no-commit --no-push"
  build-paper:
    cmd: calkit xenv -n tex --no-check -- latexmk -cd -interaction=nonstopmode -f
      -pdf paper/main.tex
    deps:
    - path: .calkit/env-locks/tex.json
      hash: md5
      md5: 1d0f47499b5986e3b18b700441dc8e3d
      size: 1045
    - path: paper/aasjournal.bst
      hash: md5
      md5: 1e2d4614828005814bd64e3c665b8e99
      size: 36130
    - path: paper/aastex631.cls
      hash: md5
      md5: 3a8503ea2dc529eec05658a2b11d12d0
      size: 231673
    - path: paper/figures/workflow.pdf
      hash: md5
      md5: bbdeb3fea7b0d744ffba650a0d0c40db
      size: 7722175
    - path: paper/main.tex
      hash: md5
      md5: eeabd39becb757109259b403cbd55fb4
      size: 30308
    - path: paper/references.bib
      hash: md5
      md5: 1c4bda6ff1237961e82fc142650d08b6
      size: 1030386
    - path: paper/results.tex
      hash: md5
      md5: c13e23589a77173ddec14e1c43937a53
      size: 188
    outs:
    - path: paper/main.pdf
      hash: md5
      md5: 298ec87438d43564532c186a16b063ea
      size: 7960738
  run-benchmarks:
    cmd: bash --noprofile --norc scripts/run-benchmarks.sh
    deps:
    - path: boom/Cargo.lock
      hash: md5
      md5: 9bfc469a3d04968b453874c8c2ada965
      size: 126660
    - path: boom/src
      hash: md5
      md5: 500a1fa9e0f050c1f7c52eede63dd758.dir
      size: 252247
      nfiles: 37
    - path: scripts/run-benchmarks.sh
      hash: md5
      md5: 1c645c1912c220a6f1f1b07e0d2241dc
      size: 369
    outs:
    - path: paper/results.tex
      hash: md5
      md5: c13e23589a77173ddec14e1c43937a53
      size: 188
  _check-env-boom:
    cmd: calkit check environment --name boom
    deps:
    - path: Dockerfile-boom
      hash: md5
      md5: f38d41b714385e400ba4b7c53d1d7dab
      size: 1225
    outs:
    - path: .calkit/env-locks/boom.json
      hash: md5
      md5: 4641a035a76433c2f86a215861a39647
      size: 1309
  benchmark-boom:
    cmd: bash --noprofile --norc scripts/benchmark-boom.sh
    deps:
    - path: .calkit/env-locks/boom.json
      hash: md5
      md5: 4641a035a76433c2f86a215861a39647
      size: 1309
    - path: boom/Cargo.lock
      hash: md5
      md5: 9bfc469a3d04968b453874c8c2ada965
      size: 126660
    - path: boom/Cargo.toml
      hash: md5
      md5: 8e8daf6d3bec0efbad62c78c6ca7eeef
      size: 1489
    - path: boom/src
      hash: md5
      md5: 500a1fa9e0f050c1f7c52eede63dd758.dir
      size: 252247
      nfiles: 37
    - path: config/boom/compose.yaml
      hash: md5
      md5: 8e316864aaabd27afacf74d3a2f6e214
      size: 3858
    - path: config/boom/config-consumer.yaml
      hash: md5
      md5: e84e781c5978506b93283e865bf039ec
      size: 1823
    - path: config/boom/config.yaml
      hash: md5
      md5: b752fb658677c78ccdfb44bda085910d
      size: 1816
    - path: scripts/benchmark-boom.sh
      hash: md5
      md5: 2b632ef08192515cb6f0aaad6caa8fb3
      size: 805
      isexec: true
    outs:
    - path: logs/boom/consumer.log
      hash: md5
      md5: 779b6a3e4b6e7b0fa8791e21b9bc81cf
      size: 76924
    - path: logs/boom/producer.log
      hash: md5
      md5: 67df914fcdaaa4d9cc494339c94423bf
      size: 629
    - path: logs/boom/scheduler.log
      hash: md5
      md5: cb37a4d032818e9b1f8d87e785b4a55a
      size: 789690
  make-kowalski-version-file:
    cmd: bash --noprofile --norc -c "echo benchmarking > kowalski/version.txt"
